---
title: random
date: 2020-12-26 11:11:11 +/-TTTT
categories: [CTF,pwnable]
tags: [c,binary,pwn]
---

Daddy, teach me how to use random value in programming!

ssh random@pwnable.kr -p2222 (pw:guest)


ssh in the box and we got three files. `flag`,`random` and `random.c`.

First we analyze the c code.

```c

#include <stdio.h>

int main(){
        unsigned int random;
        random = rand();        // random value!

        unsigned int key=0;
        scanf("%d", &key);

        if( (key ^ random) == 0xdeadbeef ){
                printf("Good!\n");
                system("/bin/cat flag");
                return 0;
        }

        printf("Wrong, maybe you should try 2^32 cases.\n");
        return 0;
}
```

it create `random` variable and asign it to `rand()` output.
`rand()` generate randome number.

next it declare variable `key` and asign it value 0.

then it ask for our input and asign it to `key`.

if block perform `bitwise XOR` operation between `key` and random number generated by `rand()`. then it compare it to `0xdeadbeef`. if match then it gives us flag.

`bitwise XOR` compare two binary value. if bits of two operands are opposite then it result in `1`.

eg : 
```
1001
0101
-----
1100
```

here trick is if you use `rand()` without `srand()` it will generate same sequence of numbers each time it runs.

so we have to find that first number which `rand()` generate.

write a simple c program using `rand()`

```c
#include <stdio.h>

int main(){
        unsigned int random;
        random = rand();

        printf("%d\n", random);
        return 0;
}
```
compile it.
```bash
random@pwnable:/tmp/demodir$ gcc -o test test.c
```
give execuation permission and run binary.

```bash
random@pwnable:/tmp/demodir$ chmod +x test
random@pwnable:/tmp/demodir$ ./test
1804289383
```
it gives number which `rand()` generate first time when we executes program.

next we has to find key. we reverse the bitwise operation to get key.

```python3
>>> 1804289383 ^ 0xdeadbeef
3039230856
```

now we have our key and random number to satisfy `if condition`.

```bash
random@pwnable:~$ ./random 
3039230856
Good!
Mommy, I thought libc random is unpredictable...
```

and we got our flag.

> Mommy, I thought libc random is unpredictable...

